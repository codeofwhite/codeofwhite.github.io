<!DOCTYPE html>
<html lang="zh-cn">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>WSL ä¸‹æ­å»º Spark è°ƒè¯•ç¯å¢ƒæŒ‡å— | CodeMist Â· è®°å½•æŠ€æœ¯ä¸ç”Ÿæ´»</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="è¿™æ˜¯ä¸€ç¯‡è®°å½•åœ¨ WSL ç¯å¢ƒä¸‹æ­å»º Spark è°ƒè¯•ç¯å¢ƒæ—¶é‡åˆ°çš„é—®é¢˜åŠå…¶è§£å†³æ–¹æ³•çš„åšå®¢ï¼Œæ–¹ä¾¿æ—¥åæ’é›·å¤ç”¨ã€‚">
    <meta name="generator" content="Hugo 0.152.2">
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    <meta name="author" content="CodeMist">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >




    


    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/posts/spark-wsl/wsl-%E6%90%AD%E5%BB%BA-spark-debug/">
    

    <meta property="og:url" content="http://localhost:1313/posts/spark-wsl/wsl-%E6%90%AD%E5%BB%BA-spark-debug/">
  <meta property="og:site_name" content="CodeMist Â· è®°å½•æŠ€æœ¯ä¸ç”Ÿæ´»">
  <meta property="og:title" content="WSL ä¸‹æ­å»º Spark è°ƒè¯•ç¯å¢ƒæŒ‡å—">
  <meta property="og:description" content="è¿™æ˜¯ä¸€ç¯‡è®°å½•åœ¨ WSL ç¯å¢ƒä¸‹æ­å»º Spark è°ƒè¯•ç¯å¢ƒæ—¶é‡åˆ°çš„é—®é¢˜åŠå…¶è§£å†³æ–¹æ³•çš„åšå®¢ï¼Œæ–¹ä¾¿æ—¥åæ’é›·å¤ç”¨ã€‚">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-04-26T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-04-26T00:00:00+00:00">
    <meta property="article:tag" content="WSL">
    <meta property="article:tag" content="Spark">
    <meta property="article:tag" content="Hadoop">

  <meta itemprop="name" content="WSL ä¸‹æ­å»º Spark è°ƒè¯•ç¯å¢ƒæŒ‡å—">
  <meta itemprop="description" content="è¿™æ˜¯ä¸€ç¯‡è®°å½•åœ¨ WSL ç¯å¢ƒä¸‹æ­å»º Spark è°ƒè¯•ç¯å¢ƒæ—¶é‡åˆ°çš„é—®é¢˜åŠå…¶è§£å†³æ–¹æ³•çš„åšå®¢ï¼Œæ–¹ä¾¿æ—¥åæ’é›·å¤ç”¨ã€‚">
  <meta itemprop="datePublished" content="2025-04-26T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-04-26T00:00:00+00:00">
  <meta itemprop="wordCount" content="250">
  <meta itemprop="keywords" content="WSL,Spark,Hadoop">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="WSL ä¸‹æ­å»º Spark è°ƒè¯•ç¯å¢ƒæŒ‡å—">
  <meta name="twitter:description" content="è¿™æ˜¯ä¸€ç¯‡è®°å½•åœ¨ WSL ç¯å¢ƒä¸‹æ­å»º Spark è°ƒè¯•ç¯å¢ƒæ—¶é‡åˆ°çš„é—®é¢˜åŠå…¶è§£å†³æ–¹æ³•çš„åšå®¢ï¼Œæ–¹ä¾¿æ—¥åæ’é›·å¤ç”¨ã€‚">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-gray">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l center items-center justify-between">
    <a href="/" class="f3 fw2 hover-white white-90 dib no-underline">
      
        CodeMist Â· è®°å½•æŠ€æœ¯ä¸ç”Ÿæ´»
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white white-90 no-underline" href="/" title="é¦–é¡µ page">
              é¦–é¡µ
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white white-90 no-underline" href="/posts/" title="æ–‡ç« æ±‡é›† page">
              æ–‡ç« æ±‡é›†
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white white-90 no-underline" href="/categories/bigdata/" title="å¤§æ•°æ®å¼€å‘ç¬”è®° page">
              å¤§æ•°æ®å¼€å‘ç¬”è®°
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white white-90 no-underline" href="/categories/ai/" title="AI page">
              AI
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white white-90 no-underline" href="/categories/daily-study/" title="æ—¥å¸¸å’Œå­¦ä¹  page">
              æ—¥å¸¸å’Œå­¦ä¹ 
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white white-90 no-underline" href="/about/" title="å…³äº page">
              å…³äº
            </a>
          </li>
          
        </ul>
      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  
  <article class="flex-l mw8 center ph3 flex-wrap justify-between">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">WSL ä¸‹æ­å»º Spark è°ƒè¯•ç¯å¢ƒæŒ‡å—</h1>
      
      <p class="tracked"><strong>CodeMist</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2025-04-26T00:00:00Z">April 26, 2025</time>
      

      
      
        <span class="f6 mv4 dib tracked"> - 2 minutes read </span>
        <span class="f6 mv4 dib tracked"> - 250 words </span>
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links text-light pr4-l w-two-thirds-l"><p>è¿™æ˜¯ä¸€ç¯‡è®°å½•åœ¨ WSL ç¯å¢ƒä¸‹æ­å»º Spark è°ƒè¯•ç¯å¢ƒæ—¶é‡åˆ°çš„é—®é¢˜åŠå…¶è§£å†³æ–¹æ³•çš„åšå®¢ï¼Œæ–¹ä¾¿æ—¥åæ’é›·å¤ç”¨ã€‚</p>
<h2 id="-bug-1ç”¨æˆ·æƒé™é—®é¢˜">ğŸ’¥ Bug 1ï¼šç”¨æˆ·æƒé™é—®é¢˜</h2>
<p>å¯åŠ¨ Hadoop æ—¶å‡ºç°é”™è¯¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ERROR: namenode can only be executed by root.
</span></span></code></pre></div><p>æ’æŸ¥åå‘ç°ï¼Œ<code>start-dfs.sh</code> è„šæœ¬ä¸­å¯¹æ‰§è¡Œç”¨æˆ·æœ‰é™åˆ¶ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œå½“å‰ç”¨æˆ·é root æ—¶ä¼šæŠ¥é”™ï¼š</p>
<p><img src="/images/image.png" alt="alt text"></p>
<p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨ root ç”¨æˆ·æ‰§è¡Œå¯åŠ¨è„šæœ¬ï¼Œæˆ–</li>
<li>ä¿®æ”¹ <code>start-dfs.sh</code> ä¸­çš„ç”¨æˆ·æ ¡éªŒï¼ˆä»…å»ºè®®åœ¨å¼€å‘ç¯å¢ƒä½¿ç”¨ï¼‰</li>
</ul>
<hr>
<h2 id="-bug-2ssh-æ— å¯†ç ç™»å½•å¤±è´¥">ğŸš« Bug 2ï¼šSSH æ— å¯†ç ç™»å½•å¤±è´¥</h2>
<p>æŠ¥é”™ä¿¡æ¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">localhost: zhj20@localhost: Permission denied <span class="o">(</span>publickey,password<span class="o">)</span>
</span></span></code></pre></div><p>è¯´æ˜ SSH æ— å¯†ç ç™»å½•æœªé…ç½®ï¼ŒHadoop å¯åŠ¨è¿‡ç¨‹ä¸­çš„å†…éƒ¨é€šä¿¡å¤±è´¥ã€‚</p>
<p><strong>è§£å†³æ­¥éª¤ï¼š</strong></p>
<ol>
<li>
<p><strong>ç”Ÿæˆ SSH å¯†é’¥ï¼ˆè‹¥æ— ï¼‰</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh-keygen -t rsa -P <span class="s1">&#39;&#39;</span> -f ~/.ssh/id_rsa
</span></span></code></pre></div></li>
<li>
<p><strong>é…ç½®å…¬é’¥è®¤è¯</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys
</span></span><span class="line"><span class="cl">chmod <span class="m">600</span> ~/.ssh/authorized_keys
</span></span></code></pre></div></li>
<li>
<p><strong>éªŒè¯æ˜¯å¦èƒ½å…å¯†ç™»å½•</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh localhost
</span></span></code></pre></div></li>
</ol>
<p>æˆåŠŸååº”è‡ªåŠ¨ç™»å½•ï¼Œæ— éœ€è¾“å…¥å¯†ç ï¼Œ<code>exit</code> é€€å‡ºå³å¯ã€‚</p>
<hr>
<h2 id="-bug-3yarn-èŠ‚ç‚¹åˆ—è¡¨ä¸ºç©º">ğŸ§­ Bug 3ï¼šYARN èŠ‚ç‚¹åˆ—è¡¨ä¸ºç©º</h2>
<p>æ‰§è¡Œ <code>yarn node -list</code> æ—¶æ— ä»»ä½•èŠ‚ç‚¹ã€‚</p>
<p><strong>æ’æŸ¥æ–¹å‘ï¼š</strong></p>
<ul>
<li>ç¡®è®¤ ResourceManager å’Œ NodeManager æ˜¯å¦éƒ½å·²å¯åŠ¨ï¼ˆ<code>jps</code> æŸ¥çœ‹ï¼‰</li>
<li>æ£€æŸ¥ <code>yarn-site.xml</code> é…ç½®æ˜¯å¦æ­£ç¡®</li>
<li>æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æ˜¯å¦æœ‰ç½‘ç»œè¿æ¥/ç«¯å£å¼‚å¸¸</li>
</ul>
<hr>
<h2 id="-bug-4namenode-å¯åŠ¨å¤±è´¥editlog-å¼‚å¸¸">ğŸ’£ Bug 4ï¼šNameNode å¯åŠ¨å¤±è´¥ï¼ˆEditLog å¼‚å¸¸ï¼‰</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">There appears to be a gap in the edit log. We expected txid 1, but got txid 113.
</span></span></code></pre></div><p><strong>åŸå› åˆ†æï¼š</strong></p>
<ul>
<li>Hadoop æ¢å¤ fsimage + editlog æ—¶å‘ç° txid åºå·ä¸è¿ç»­ï¼Œeditlog å¯èƒ½æŸåæˆ–ç¼ºå¤±ã€‚</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼ˆæ— é‡è¦æ•°æ®æ—¶ï¼‰ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hdfs namenode -format
</span></span><span class="line"><span class="cl">./sbin/start-dfs.sh
</span></span></code></pre></div><p>âš ï¸ æ³¨æ„ï¼šæ­¤æ“ä½œä¼šæ¸…ç©º HDFS ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œä»…å»ºè®®åœ¨è°ƒè¯•æˆ–å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨ï¼</p>
<hr>
<h2 id="-bug-5datanode-å¯åŠ¨å¤±è´¥æ— æ³•å†™å…¥å‰¯æœ¬">ğŸ”¥ Bug 5ï¼šDataNode å¯åŠ¨å¤±è´¥ï¼Œæ— æ³•å†™å…¥å‰¯æœ¬</h2>
<p>é”™è¯¯ä¿¡æ¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">File ... could only be written to <span class="m">0</span> of the <span class="m">1</span> minReplication nodes. There are <span class="m">0</span> datanode<span class="o">(</span>s<span class="o">)</span> running
</span></span></code></pre></div><p>æ’æŸ¥é…ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat <span class="nv">$HADOOP_HOME</span>/etc/hadoop/hdfs-site.xml <span class="p">|</span> grep -A <span class="m">5</span> dfs.datanode.data.dir
</span></span></code></pre></div><p>æ—¥å¿—æç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Incompatible clusterIDs
</span></span><span class="line"><span class="cl">namenode <span class="nv">clusterID</span> <span class="o">=</span> CID-018939f5...
</span></span><span class="line"><span class="cl">datanode <span class="nv">clusterID</span> <span class="o">=</span> CID-659a4b77...
</span></span></code></pre></div><p>è¯´æ˜ DataNode ä¿å­˜çš„ clusterID ä¸ NameNode ä¸ä¸€è‡´ã€‚</p>
<p><strong>è§£å†³åŠæ³•ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åœæ­¢ Hadoop</span>
</span></span><span class="line"><span class="cl">./sbin/stop-dfs.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¸…é™¤ DataNode æ•°æ®ï¼ˆä¸è¦åˆ  NameNode æ•°æ®ï¼ï¼‰</span>
</span></span><span class="line"><span class="cl">rm -rf /opt/module/hadoop-3.4.1/hadoop_data/hdfs/datanode/*
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é‡å¯</span>
</span></span><span class="line"><span class="cl">./sbin/start-dfs.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹æ˜¯å¦æ­£å¸¸å¯åŠ¨</span>
</span></span><span class="line"><span class="cl">jps
</span></span></code></pre></div><hr>
<h2 id="-é—®é¢˜æ€»ç»“">ğŸ“Œ é—®é¢˜æ€»ç»“</h2>
<table>
  <thead>
      <tr>
          <th>é—®é¢˜æè¿°</th>
          <th>å»ºè®®è§£å†³æ–¹å¼</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>namenode</code> æŠ¥åªèƒ½ç”± root æ‰§è¡Œ</td>
          <td>ä½¿ç”¨ root å¯åŠ¨ï¼Œæˆ–è°ƒæ•´è„šæœ¬æƒé™æ ¡éªŒ</td>
      </tr>
      <tr>
          <td>SSH ç™»å½•å¤±è´¥</td>
          <td>é…ç½®æœ¬æœºå…å¯†ç™»å½•ï¼ˆ<code>ssh localhost</code>ï¼‰</td>
      </tr>
      <tr>
          <td>YARN æ— èŠ‚ç‚¹</td>
          <td>æ£€æŸ¥ NodeManager æ˜¯å¦è¿è¡Œï¼ŒæŸ¥çœ‹æ—¥å¿—</td>
      </tr>
      <tr>
          <td>NameNode å¯åŠ¨å¤±è´¥ï¼ˆtxid gapï¼‰</td>
          <td>æ ¼å¼åŒ– NameNodeï¼ˆå¼€å‘ç¯å¢ƒå¯ç”¨ï¼‰</td>
      </tr>
      <tr>
          <td>DataNode æŠ¥ ClusterID ä¸ä¸€è‡´</td>
          <td>æ¸…ç©º datanode æ•°æ®ç›®å½•ï¼Œé‡æ–°å¯åŠ¨å³å¯</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-å‚è€ƒé“¾æ¥">ğŸ”— å‚è€ƒé“¾æ¥</h2>
<ul>
<li><a href="https://chatgpt.com/share/680c4e86-85fc-800f-917c-db92b4a6e81c">WSL é…ç½® Spark çš„å‘ï¼ˆChatGPT åˆ†äº«é¡µ 1ï¼‰</a></li>
<li><a href="https://chatgpt.com/share/680c4ead-ee00-800f-ab1d-47c1235f3bf0">è°ƒè¯• HDFS NameNode å¯åŠ¨å¤±è´¥ï¼ˆChatGPT åˆ†äº«é¡µ 2ï¼‰</a></li>
<li><a href="https://chatgpt.com/share/680c4ebc-5f4c-800f-a2ef-247f8d461413">DataNode ClusterID ä¸ä¸€è‡´æ’æŸ¥è®°å½•ï¼ˆChatGPT åˆ†äº«é¡µ 3ï¼‰</a></li>
</ul><ul class="pa0">
  
   <li class="list di">
     <a href="/tags/wsl/" class="link f5 grow br-pill ba ph3 pv2 mb2 dib black sans-serif no-underline">WSL</a>
   </li>
  
   <li class="list di">
     <a href="/tags/spark/" class="link f5 grow br-pill ba ph3 pv2 mb2 dib black sans-serif no-underline">Spark</a>
   </li>
  
   <li class="list di">
     <a href="/tags/hadoop/" class="link f5 grow br-pill ba ph3 pv2 mb2 dib black sans-serif no-underline">Hadoop</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




  <div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">Related</p>
    <ul class="pa0 list">
	   
	     <li  class="mb2">
          <a href="/posts/spark-wsl/spark-yarn-%E5%90%AF%E5%8A%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/">Spark Yarn å¯åŠ¨ä¸å…³é—­çš„æ³¨æ„äº‹é¡¹æ€»ç»“</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/posts/spark-wsl/spark-%E7%9A%84%E5%87%A0%E7%A7%8D%E5%90%AF%E5%8A%A8%E6%96%B9%E5%BC%8F/">Spark çš„å‡ ç§å¯åŠ¨æ–¹å¼</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/posts/spark-wsl/spark-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">Spark æœºå™¨å­¦ä¹  ä¸ Pytorch åˆ†åˆ«</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/posts/spark-wsl/spark-wsl-%E9%85%8D%E7%BD%AE/">WSL é…ç½® Spark</a>
        </li>
	    
    </ul>
</div>

</aside>

  </article>

    </main>
    <footer class="bg-gray bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white white-70 dn dib-ns pv2 ph3 no-underline" href="http://localhost:1313/" >
    &copy;  CodeMist Â· è®°å½•æŠ€æœ¯ä¸ç”Ÿæ´» 2025 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
